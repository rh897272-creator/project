<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Osyam VP</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
body{
  margin:0;
  font-family:'Segoe UI',sans-serif;
  background:linear-gradient(135deg,#0f0f0f,#1a1a1a,#000);
  color:#fff;
}

/* ====== HEADER ====== */
.topbar{
  padding:25px 20px;
  text-align:center;
  background:linear-gradient(135deg,#000,#111,#000);
  box-shadow:0 5px 30px rgba(0,0,0,0.8);
}

.logo{
  font-size:28px;
  font-weight:900;
  letter-spacing:2px;
  text-transform:uppercase;
  background:linear-gradient(90deg,#ffd700,#ffae00,#ffd700);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}

.logo span{
  background:linear-gradient(90deg,#ffffff,#ffd700);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}

.crown{
  color:#ffd700;
  margin-left:8px;
  animation:glow 2s infinite alternate;
}

@keyframes glow{
from{ text-shadow:0 0 5px #ffd700; }
to{ text-shadow:0 0 20px #ffcc00; }
}

/* ====== ADS FADE ====== */
.ads-container{
  width:95%;
  height:180px;
  margin:20px auto;
  position:relative;
  overflow:hidden;
  border-radius:20px;
  box-shadow:0 10px 30px rgba(0,0,0,0.7);
}

.ads-container img{
  position:absolute;
  width:100%;
  height:100%;
  object-fit:cover;
  opacity:0;
  transition:opacity 0.7s ease-in-out;
}

.ads-container img.active{
  opacity:1;
}

/* ====== CONTENT ====== */
.content{
  padding:20px;
  padding-bottom:100px;
}

.card{
  background:rgba(255,255,255,0.05);
  backdrop-filter:blur(15px);
  border-radius:20px;
  padding:20px;
  margin-bottom:20px;
  box-shadow:0 10px 25px rgba(0,0,0,0.6);
  transition:0.3s;
}

.card h3{
  margin:0 0 10px;
  color:#ffd700;
}

.card p{
  margin:0;
  font-size:18px;
  font-weight:bold;
}

/* ====== BOTTOM NAV ====== */
.bottom-nav{
  position:fixed;
  bottom:0;
  left:0;
  width:100%;
  background:rgba(0,0,0,0.95);
  display:flex;
  justify-content:space-around;
  padding:15px 0;
  box-shadow:0 -5px 25px rgba(0,0,0,0.8);
}

.bottom-nav button{
  background:none;
  border:none;
  color:#fff;
  font-size:22px;
  cursor:pointer;
  transition:0.3s;
}

.bottom-nav button:hover{
  color:#ffd700;
  transform:scale(1.2);
}
</style>
</head>

<body>
<!-- HEADER -->
<div class="topbar">
  <div class="logo">
    <i class="fas fa-crown crown"></i>
    Osyam <span>VP</span>
  </div>
</div>

<!-- ADS FADE -->
<div class="ads-container">
  <img src="https://i.postimg.cc/nhfKZJFk/Ew-Olzce-Wg-AIph-Cq.jpg" class="active">
  <img src="https://i.postimg.cc/WbkmQ3vK/images-(21).jpg">
  <img src="https://i.postimg.cc/tCxdLTjv/images-(22).jpg">
  <img src="https://i.postimg.cc/hPd8HjB6/images-(23).jpg">
  <img src="https://i.postimg.cc/Njv8YcsD/OSAM-1-Auto8.jpg">
</div>

<!-- CONTENT: Ø§Ù„Ø±ØµÙŠØ¯ ÙˆØ§Ù„Ù…Ø³ØªÙˆÙ‰ ÙˆØ£Ø­Ø¯Ø« Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª -->
<div class="content">
  <div class="card">
    <h3>ğŸ’° Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ</h3>
    <p id="balanceBox">0 Ø¯Ø¬</p>
  </div>
  <div class="card">
    <h3>â­ Ø§Ù„Ù…Ø³ØªÙˆÙ‰</h3>
    <p>VIP 0</p>
  </div>
  <div class="card history" id="history">
  <h3>ğŸ Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ù‡Ø¯ÙŠØ©</h3>
  <div id="historyList">
    <button id="giftBtn" class="vp-btn">ğŸ Ø§Ø¶ØºØ· Ù‡Ù†Ø§</button>
  </div>
</div>

<!-- Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© -->
<div id="giftPopup" class="vp-popup">
  <h3>Ø§Ø¯Ø®Ù„ Ø±Ù…Ø²Ùƒ</h3>
  <input type="text" id="giftCode" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø²">
  <div class="popup-buttons">
    <button id="submitGift" class="vp-btn">âœ… ØªØ­Ù‚Ù‚</button>
    <button id="closeGift" class="vp-btn close-btn">âŒ Ø¥ØºÙ„Ø§Ù‚</button>
  </div>
  <div id="giftStatus" class="gift-status"></div>
</div>

<style>
.vp-btn{
  padding:12px 20px;
  border:none;
  border-radius:20px;
  background:linear-gradient(145deg,#111,#222);
  color:#00ff00;
  font-weight:bold;
  font-size:16px;
  cursor:pointer;
  box-shadow:0 0 10px #00ff0033, 0 0 20px #00ff0055 inset;
  transition:0.3s;
  margin-top:10px;
}
.vp-btn:hover{
  box-shadow:0 0 15px #00ff0055, 0 0 30px #00ff0077 inset;
  transform:scale(1.05);
}

.vp-popup{
  display:none;
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  background:rgba(20,20,20,0.95);
  padding:25px;
  border-radius:25px;
  box-shadow:0 0 20px #00ff0033, inset 0 0 10px #00ff0033;
  color:#0f0;
  text-align:center;
  min-width:300px;
  z-index:999;
}
.vp-popup input{
  width:80%;
  padding:10px;
  border-radius:15px;
  border:none;
  outline:none;
  background:#111;
  color:#0f0;
  font-size:16px;
  margin-top:10px;
}
.popup-buttons{
  margin-top:15px;
}
.close-btn{
  background:linear-gradient(145deg,#220000,#330000);
  color:#ff5555;
  margin-left:10px;
}
.gift-status{
  margin-top:12px;
  font-weight:bold;
  color:#ff0;
  min-height:20px;
}
</style>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";
import { getFirestore, doc, getDoc, updateDoc, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

// Ø¥Ø¹Ø¯Ø§Ø¯ Firebase
const firebaseConfig = {
  apiKey: "AIzaSyBiQ4dHe4sbKDIrsyF8WdpjV3sY4qAxU4E",
  authDomain: "osim-d1821.firebaseapp.com",
  projectId: "osim-d1821",
  storageBucket: "osim-d1821.firebasestorage.app",
  messagingSenderId: "464951343183",
  appId: "1:464951343183:web:21c7615a90e4f38385923a"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// Ø§Ù„Ø¹Ù†Ø§ØµØ±
const giftBtn = document.getElementById("giftBtn");
const giftPopup = document.getElementById("giftPopup");
const closeGift = document.getElementById("closeGift");
const submitGift = document.getElementById("submitGift");
const giftCodeInput = document.getElementById("giftCode");
const giftStatus = document.getElementById("giftStatus");
const balanceBox = document.getElementById("balanceBox");

let uid = null;

// ÙØªØ­ ÙˆØ¥ØºÙ„Ø§Ù‚ popup
giftBtn.onclick = () => {
  giftPopup.style.display = "block"; 
  giftStatus.textContent = ""; 
  giftCodeInput.value = "";
}
closeGift.onclick = () => { giftPopup.style.display = "none"; }

// Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
onAuthStateChanged(auth, user=>{
  if(!user){ 
    window.location.href = "login.html"; 
    return; 
  }
  uid = user.uid;
});

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù…Ø² ÙˆØ±Ø¨Ø·Ù‡ Ø¨Ù€ Firebase
submitGift.onclick = async () => {
  const code = giftCodeInput.value.trim().toUpperCase();
  if(!code){ giftStatus.textContent="âŒ Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² ØµØ­ÙŠØ­"; return; }
  if(!uid){ giftStatus.textContent="âŒ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø·Ù„ÙˆØ¨"; return; }

  // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø±Ù…Ø² ÙÙŠ Ù…Ø¬Ù…ÙˆØ¹Ø© giftCodes
  const q = query(collection(db,"giftCodes"), where("code","==",code));
  const querySnap = await getDocs(q);

  if(querySnap.empty){
    giftStatus.textContent = "âŒ Ø§Ù„Ø±Ù…Ø² ØºÙŠØ± ØµØ§Ù„Ø­";
    return;
  }

  const giftDoc = querySnap.docs[0];
  const giftData = giftDoc.data();

  // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… ØªØ¬Ø§ÙˆØ² Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø³Ù…ÙˆØ­
  const usedBy = giftData.usedBy || [];
  const maxUsers = giftData.maxUsers || 1;

  if(usedBy.includes(uid)){
    giftStatus.textContent = "âŒ Ù„Ù‚Ø¯ Ø§Ø³ØªØ®Ø¯Ù…Øª Ù‡Ø°Ø§ Ø§Ù„Ø±Ù…Ø² Ù…Ø³Ø¨Ù‚Ø§Ù‹";
    return;
  }
  if(usedBy.length >= maxUsers){
    giftStatus.textContent = "âŒ Ù‡Ø°Ø§ Ø§Ù„Ø±Ù…Ø² Ø§Ù†ØªÙ‡Øª ØµÙ„Ø§Ø­ÙŠØªÙ‡";
    return;
  }

  // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±ØµÙŠØ¯ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
  const value = Number(giftData.amount || giftData.amount50 || 0);
  const userRef = doc(db,"users",uid);
  const userSnap = await getDoc(userRef);
  let balance = 0;
  if(userSnap.exists()){
    balance = userSnap.data().balance || 0;
  }
  const newBalance = balance + value;

  // ØªØ­Ø¯ÙŠØ« Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  await updateDoc(userRef,{ balance: newBalance });

  // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø°ÙŠÙ† Ø§Ø³ØªØ®Ø¯Ù…ÙˆØ§ Ø§Ù„Ø±Ù…Ø²
  usedBy.push(uid);
  await updateDoc(doc(db,"giftCodes",giftDoc.id),{ usedBy });

  // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  balanceBox.textContent = newBalance;
  giftStatus.textContent = `âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© ${value} Ø¯Ø¬ Ø¥Ù„Ù‰ Ø±ØµÙŠØ¯Ùƒ`;
  giftCodeInput.value = "";
};
</script>
<div class="bottom-nav">
  <button onclick="location.href='login.html'"><i class="fas fa-home"></i></button>
  <button onclick="location.href='wheel.html'"><i class="fas fa-chart-line"></i></button>
  <button onclick="location.href='deposit.html'"><i class="fas fa-piggy-bank"></i></button>
  <button onclick="location.href='withdraw.html'"><i class="fas fa-money-bill-wave"></i></button>
  <button onclick="location.href='referral.html'"><i class="fas fa-users"></i></button>
  <button onclick="location.href='tasks.html'"><i class="fas fa-tasks"></i></button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";

// Ø¥Ø¹Ø¯Ø§Ø¯ Firebase
const firebaseConfig = {
  apiKey: "AIzaSyBiQ4dHe4sbKDIrsyF8WdpjV3sY4qAxU4E",
  authDomain: "osim-d1821.firebaseapp.com",
  projectId: "osim-d1821",
  storageBucket: "osim-d1821.firebasestorage.app",
  messagingSenderId: "464951343183",
  appId: "1:464951343183:web:21c7615a90e4f38385923a"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);

const balanceBox = document.getElementById("balanceBox");

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
onAuthStateChanged(auth, async (user) => {
  if(user){
    // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ØŒ Ù†Ø¬ÙŠØ¨ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡
    const userSnap = await getDoc(doc(db,"users",user.uid));
    if(userSnap.exists()){
      const data = userSnap.data();
      balanceBox.textContent = (data.balance || 0) + " Ø¯Ø¬";
      // Ù…Ù…ÙƒÙ† ØªØ¶ÙŠÙ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ÙˆØ§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø¨Ù†ÙØ³ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø©
      document.querySelector(".content .card:nth-child(2) p").textContent = "VIP " + (data.level || 0);
      document.querySelector(".content .card:nth-child(3) p").textContent = (data.latestOperations || "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª Ø­Ø§Ù„ÙŠØ§Ù‹");
    }
  }else{
    // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„
    alert("âŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹");
    window.location.href = "login.html"; // ØªØ­ÙˆÙŠÙ„ Ù„ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
  }
});
</script>
</body><!-- Ø²Ø± Ù„ÙØªØ­ Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© -->
<button id="openLinks" class="vp-btn">ğŸŒ Ø±ÙˆØ§Ø¨Ø·Ù†Ø§</button>

<!-- Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© -->
<div id="linksPopup" class="vp-popup">
  <h3>ğŸ”— Ø§Ù†Ø¶Ù… Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§ØªÙ†Ø§ ÙˆØ­Ù…Ù‘Ù„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</h3>
  <div class="popup-buttons">
    <button onclick="window.open('https://chat.whatsapp.com/HUK4pE0BbRFFKmfjefChCq','_blank')" class="vp-btn">ğŸ’¬ Ù…Ø¬Ù…ÙˆØ¹Ø© ÙˆØ§ØªØ³Ø§Ø¨</button>
    <button onclick="window.open('https://t.me/+mtRU5ON0f4MzZDFk','_blank')" class="vp-btn">ğŸ“± Ù…Ø¬Ù…ÙˆØ¹Ø© ØªÙŠÙ„ØºØ±Ø§Ù…</button>
    <button onclick="window.location.href='https://median.co/share/jbwojoy#apk'" class="vp-btn">â¬‡ï¸ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</button>
    <button id="closeLinks" class="vp-btn close-btn">âŒ Ø¥ØºÙ„Ø§Ù‚</button>
  </div>
</div>

<style>
/* Ø²Ø± VP Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹ */
.vp-popup{
  display:none;
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  background:rgba(20,20,20,0.85); /* Ù„ÙˆÙ† Ø´ÙØ§Ù */
  padding:25px;
  border-radius:25px;
  box-shadow:0 0 20px #00ff0033, inset 0 0 10px #00ff0033;
  color:#0f0;
  text-align:center;
  min-width:300px;
  z-index:999;
}
.vp-popup h3{
  margin-bottom:15px;
  color:#ffd700;
}
.popup-buttons{
  display:flex;
  flex-direction:column;
  gap:10px;
  margin-top:10px;
}
.close-btn{
  background:linear-gradient(145deg,#220000,#330000);
  color:#ff5555;
  margin-top:10px;
}
</style>

<script>
// ÙØªØ­ ÙˆØ¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù„ÙˆØ­Ø©
const openLinks = document.getElementById('openLinks');
const linksPopup = document.getElementById('linksPopup');
const closeLinks = document.getElementById('closeLinks');

openLinks.onclick = () => { linksPopup.style.display = 'block'; }
closeLinks.onclick = () => { linksPopup.style.display = 'none'; }
</script>
</html><!-- Ø²Ø± Ù‡Ù„Ø§Ù„ Ø±Ù…Ø¶Ø§Ù† Ø«Ø§Ø¨Øª -->
<button id="moonBtn" class="vp-moon">ğŸŒ™</button>

<style>
.vp-moon{
  position:fixed;
  bottom:20px;
  right:20px;
  width:60px;
  height:60px;
  border-radius:50%;
  background: linear-gradient(145deg,#111,#222);
  border: 2px solid #444;
  color:#ffd700;
  font-size:28px;
  cursor:pointer;
  box-shadow: 0 0 10px #ffd70055, 0 0 20px #ffd70033 inset;
  display:flex;
  justify-content:center;
  align-items:center;
  transition: transform 0.3s ease, box-shadow 0.3s ease, opacity 0.5s ease;
  z-index:1000;
  opacity:1; /* Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ù…Ø±Ø¦ÙŠØ© */
}
.vp-moon:hover{
  box-shadow:0 0 20px #ffd70077, 0 0 30px #ffd70055 inset;
  transform: scale(1.2);
}
</style>

<script>
// Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ·
const moonBtn = document.getElementById('moonBtn');
moonBtn.onclick = () => {
  window.location.href = "unsaved_file__.html"; // Ø¶Ø¹ Ù‡Ù†Ø§ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙØ­Ø©
};

// Ø¸Ù‡ÙˆØ± ÙˆØ§Ø®ØªÙØ§Ø¡ ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ 5 Ø«ÙˆØ§Ù†ÙŠ
let visible = true;
setInterval(() => {
  visible = !visible;
  moonBtn.style.opacity = visible ? 1 : 0;
}, 3000);
</script>
